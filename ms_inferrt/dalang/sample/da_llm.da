#!dalang

graph net(x, y) {
    z = ops.matmul(x, y)
    z = ops.norm(z)
    z = ops.gelu(z)
    z = ops.softmax(z)
    return ops.add(ops.add(x, y), z)
}

function main() {
    "a = int(0)
    b = 1 : int
    if a > b {
        <: 'error' <: '\n'
    }"

    'x = tensor((2, 3))
    y = tensor((3, 4))'
    x = tensor(2)
    y = tensor(3)
    'x = 2
    y = 3'
    net(x, y)
    b = net(x, y)
    return b
}

<: main() <: '\n'