#!dalang

graph net(x, y) {
    z = ops.matmul(x, y)
    z = ops.norm(z)
    z = ops.gelu(z)
    z = ops.softmax(z)
    return ops.add(ops.add(x, y), z)
}

function main() {
    x = tensor(2)
    y = tensor(3)
    net(x, y)
    b = net(x, y)
    return b
}

<: main() <: '\n'